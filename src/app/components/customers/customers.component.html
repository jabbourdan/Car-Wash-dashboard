<div class="form-group mb-3 d-flex align-items-center">
    <i class="search f-12" antIcon type="search" theme="outline"></i>
    <input type="search" class="form-control border-0 shadow-none" placeholder="Search by name, email or phone"
        [(ngModel)]="state.searchTerm" />
</div>

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Photo</th>
                <th (click)="toggleSort('name')">
                    Name
                    <span *ngIf="state.sortColumn === 'name'">
                        <i nz-icon [nzType]="'caret-up'" *ngIf="state.sortDirection === 'asc'"></i>
                        <i nz-icon [nzType]="'caret-down'" *ngIf="state.sortDirection === 'desc'"></i>
                    </span>
                </th>
                <th (click)="toggleSort('email')">
                    Email
                    <span *ngIf="state.sortColumn === 'email'">
                        <i nz-icon [nzType]="'caret-up'" *ngIf="state.sortDirection === 'asc'"></i>
                        <i nz-icon [nzType]="'caret-down'" *ngIf="state.sortDirection === 'desc'"></i>
                    </span>
                </th>
                <th (click)="toggleSort('phoneNumber')">
                    Phone
                    <span *ngIf="state.sortColumn === 'phoneNumber'">
                        <i nz-icon [nzType]="'caret-up'" *ngIf="state.sortDirection === 'asc'"></i>
                        <i nz-icon [nzType]="'caret-down'" *ngIf="state.sortDirection === 'desc'"></i>
                    </span>
                </th>
                <th>Suspension Status</th>
                <th>Approval Status</th>
            </tr>
        </thead>
        <tbody *ngIf="!isLoading else loading">
            <tr *ngFor="let customer of filteredCustomers; trackBy: trackByCustomerId">
                <td>
                    <img *ngIf="customer.photoUrl; else defaultImage" [src]="customer.photoUrl" alt="Photo" width="50"
                        height="50" />
                    <ng-template #defaultImage>
                        <img src="assets/images/user/defaultuser.jpg" alt="Default Photo" width="50" height="50" />
                    </ng-template>
                </td>
                <td>{{ customer.name }}</td>
                <td>{{ customer.email || 'N/A' }}</td>
                <td>{{ customer.phoneNumber || 'N/A' }}</td>
                <td>
                    <button (click)="toggleSuspension(customer)" [ngClass]="{
                'suspend': customer.isSuspended === true,
                'reactivate': customer.isSuspended === false
              }" class="status-btn">
                        {{ getStatusLabel(customer.isSuspended) }}
                    </button>
                </td>
                <td>
                    <button (click)="toggleApproval(customer)" [ngClass]="{
                'suspend': customer.isApproved === true,
                'reactivate': customer.isApproved === false
              }" class="status-btn">
                        {{ customer.isApproved ? 'Reject' : 'Approve' }}
                    </button>
                </td>
            </tr>
        </tbody>
    </table>

    <div *ngIf="isError" class="alert alert-danger">
        {{ errorMessage }}
    </div>
</div>

<ng-template #loading>
    <p>Loading customers...</p>
</ng-template>